# CVE-2024-52427

## Index
* [ğŸ“Œ Analysis](#-Analysis)
    * [1. ê°œìš”](#1-ê°œìš”)
    * [2. í”ŒëŸ¬ê·¸ì¸ ì„¤ëª…](#2-í”ŒëŸ¬ê·¸ì¸-ì„¤ëª…)
    * [3. ì·¨ì•½ì  ë¶„ì„](#3-ì·¨ì•½ì -ë¶„ì„)
* [ğŸ“Œ PoC](#-POC)
* [ğŸ“Œ íŒ¨ì¹˜í™•ì¸](#-íŒ¨ì¹˜í™•ì¸)

## ğŸ“Œ Analysis

### 1. ê°œìš”

`CVE-2024-52427`ì€ [Event Tickets with Ticket Scanner](https://wordpress.org/plugins/event-tickets-with-ticket-scanner/)(ì´í•˜, Event Tickets) WordPress í”ŒëŸ¬ê·¸ì¸ 2.3.11 ë²„ì „ ì´í•˜ì—ì„œ ë°œê²¬ëœ Server Side Include(SSI) Injection ì·¨ì•½ì ì…ë‹ˆë‹¤. ì´ ì·¨ì•½ì ì€ í•´ë‹¹ í”ŒëŸ¬ê·¸ì¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” `Twig` í…œí”Œë¦¿ ì—”ì§„ì˜ íŠ¹ìˆ˜ ìš”ì†Œë¥¼ ì ì ˆíˆ í•„í„°ë§í•˜ì§€ ì•Šì•„ ë°œìƒí•˜ë©°, ê¸€ ì“°ê¸° ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ì(`Contributor` ê¶Œí•œ ì´ìƒ)ê°€ ì•…ì˜ì ì¸ ì½”ë“œë¥¼ ì‚½ì…í•´ ì„œë²„ì— ì‹œìŠ¤í…œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 2. í”ŒëŸ¬ê·¸ì¸ ì„¤ëª…

Event Ticketsì€ WordPress ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì´ë²¤íŠ¸ í‹°ì¼“ì„ ìƒì„±í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” í”ŒëŸ¬ê·¸ì¸ì…ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ì½˜ì„œíŠ¸ ì…ì¥ê¶Œ íŒë§¤ ì‹œ ìƒí’ˆ ë“±ë¡ ë‹¨ê³„ì—ì„œ ì…ì¥ê¶Œ ì •ë³´ë¥¼ ì…ë ¥í•˜ë©´ ìƒí’ˆì„ êµ¬ë§¤í•œ ê³ ê°ì—ê²Œ ìƒí’ˆ ì •ë³´ê°€ í¬í•¨ëœ í‹°ì¼“ì´ ìë™ìœ¼ë¡œ ë¶€ì—¬ë©ë‹ˆë‹¤.

![ìƒí’ˆ ë“±ë¡ ì‹œ í‹°ì¼“ ì •ë³´ ì…ë ¥](images/image-001.png)

*[ìƒí’ˆ ë“±ë¡ ì‹œ í‹°ì¼“ ì •ë³´ ì…ë ¥]*

![ìƒí’ˆ ì£¼ë¬¸ ì™„ë£Œ í™”ë©´ ë‚´ í‹°ì¼“ ì •ë³´](images/image-002.png)

*[ìƒí’ˆ ì£¼ë¬¸ ì™„ë£Œ í™”ë©´ ë‚´ í‹°ì¼“ ì •ë³´]*

ìœ„ ìƒí’ˆ ì£¼ë¬¸ ì™„ë£Œ í™”ë©´ ë‚´ í‹°ì¼“ ì •ë³´ë¥¼ í´ë¦­í•  ê²½ìš° ìƒí’ˆ êµ¬ë§¤ ì •ë³´ì™€ QR ì½”ë“œê°€ ë‹´ê¸´ í‹°ì¼“ì„ ë°œê¸‰ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![image.png](images/image-003.png)

ë˜í•œ QR ì½”ë“œë¥¼ í†µí•œ í‹°ì¼“ ìŠ¤ìº” ê¸°ëŠ¥ì„ ì œê³µí•˜ë©°, í‹°ì¼“ í…œí”Œë¦¿ ì»¤ìŠ¤í„°ë§ˆì´ì§•, ì´ë²¤íŠ¸ ê´€ë¦¬, ê²°ì œ ì²˜ë¦¬ ë“± ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

![í‹°ì¼“ ìŠ¤ìºë„ˆ 1](images/image-004.png)

*[í‹°ì¼“ ìŠ¤ìºë„ˆ 1]*

![í‹°ì¼“ ìŠ¤ìºë„ˆ 2](images/image-005.png)

*[í‹°ì¼“ ìŠ¤ìºë„ˆ 2]*

### 3. ì·¨ì•½ì  ë¶„ì„

> âš ï¸  CVE ì •ë³´ì—ëŠ” ì·¨ì•½ì  ë°œìƒì— í•„ìš”í•œ ìµœì†Œ ê¶Œí•œì´ ì‘ì„±ì(`Author`) ìˆ˜ì¤€ì´ë¼ê³  ëª…ì‹œë˜ì–´ ìˆìœ¼ë‚˜, ì‹¤ì œë¡œëŠ” ë” ë‚®ì€ ê¶Œí•œì¸ ê¸°ì—¬ì(`Contributor`) ìˆ˜ì¤€ì—ì„œë„ ì·¨ì•½ì ì´ ë°œìƒí•©ë‹ˆë‹¤. ë”°ë¼ì„œ ë³¸ ë¶„ì„ì€ ê¸°ì—¬ì(`Contributor`) ê¶Œí•œì„ ê¸°ì¤€ìœ¼ë¡œ ìˆ˜í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.


Event Tickets í”ŒëŸ¬ê·¸ì¸ì€ í…œí”Œë¦¿ ì»¤ìŠ¤í„°ë§ˆì´ì§• ê¸°ëŠ¥ì„ í†µí•´ í‹°ì¼“ í˜ì´ì§€ë¥¼ ê¾¸ë°€ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ ì»¤ìŠ¤í„°ë§ˆì´ì§• ê¸°ëŠ¥ì€ Event Tickets ì„¤ì • ë©”ë‰´(`/wp-admin/admin.php?page=event-tickets-with-ticket-scanner`)ì˜ â€˜`Options`â€™ ë‚´ í‹°ì¼“ í…œí”Œë¦¿ ì„¤ì •ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

![Event Tickets ì„¤ì • ë©”ë‰´](images/image-006.png)

*[Event Tickets ì„¤ì • ë©”ë‰´]*

![Event Tickets ì„¤ì • ë©”ë‰´ ë‚´ í‹°ì¼“ í˜ì´ì§€ í…œí”Œë¦¿ ì„¤ì •](images/image-007.png)

*[Event Tickets ì„¤ì • ë©”ë‰´ ë‚´ í‹°ì¼“ í˜ì´ì§€ í…œí”Œë¦¿ ì„¤ì •]*

ì´ ì„¤ì •ì—ì„œëŠ” `HTML` ê³¼ `Twig` í…œí”Œë¦¿ ë¬¸ë²•ì„ ì‚¬ìš©í•˜ì—¬ í‹°ì¼“ì˜ ë””ìì¸ê³¼ ë‚´ìš©ì„ ììœ ë¡­ê²Œ ìˆ˜ì •í•  ìˆ˜ ìˆë„ë¡ í—ˆìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. 

í•˜ì§€ë§Œ Event Tickets í”ŒëŸ¬ê·¸ì¸ì€ ì‚¬ìš©ìê°€ ì…ë ¥í•œ `Twig` í…œí”Œë¦¿ ì½”ë“œë¥¼ ì ì ˆíˆ ê²€ì¦í•˜ì§€ ì•Šì•„ ì•…ì˜ì ì¸ ì½”ë“œê°€ ì‹¤í–‰ë  ìˆ˜ ìˆëŠ” ì·¨ì•½ì ì´ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, í•´ë‹¹ í”ŒëŸ¬ê·¸ì¸ì˜ ì„¤ì • ë©”ë‰´ëŠ” ê¸°ì—¬ì(`Contributor`) ìˆ˜ì¤€ì˜ ë‚®ì€ ì ‘ê·¼ ê¶Œí•œìœ¼ë¡œë„ ì´ìš©í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì·¨ì•½ì  ì•…ìš©ì˜ ìœ„í—˜ì„±ì´ ë†’ìŠµë‹ˆë‹¤. 

![ê¸°ì—¬ì(â€™Contributorâ€™) ê¶Œí•œì„ ê°€ì§„ ì‚¬ìš©ìì˜ Event Tickets ì„¤ì • ë©”ë‰´ì˜ í‹°ì¼“ í˜ì´ì§€ í…œí”Œë¦¿ ì„¤ì • ](images/image-008.png)

ê¸°ì—¬ì(â€™Contributorâ€™) ê¶Œí•œì„ ê°€ì§„ ì‚¬ìš©ìì˜ Event Tickets ì„¤ì • ë©”ë‰´ì˜ í‹°ì¼“ í˜ì´ì§€ í…œí”Œë¦¿ ì„¤ì • 

ë”°ë¼ì„œ WordPressì˜ ê¸°ì—¬ì(`Contributor`) ê¶Œí•œì€ ì¼ë°˜ì ìœ¼ë¡œ ì½˜í…ì¸  ì‘ì„±ê³¼ í¸ì§‘ë§Œ ê°€ëŠ¥í•˜ì§€ë§Œ, ì´ ì·¨ì•½ì ì„ í†µí•´ ì„œë²„ì˜ ì‹œìŠ¤í…œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì‹¬ê°í•œ ë³´ì•ˆ ìœ„í—˜ì„ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ“Œ POC

> âš ï¸ PoCëŠ” `Event Tickets with Ticket Scanner <= 2.3.11` ì˜ ê¸°ì—¬ì(`Contributor`) ê¶Œí•œìœ¼ë¡œ ì§„í–‰í–ˆìŠµë‹ˆë‹¤. <br>
> &nbsp;&nbsp;&nbsp;&nbsp;í•´ë‹¹ í”ŒëŸ¬ê·¸ì¸ì€ `plugins/event-tickets-with-ticket-scanner.2.3.11.zip` ì—ì„œ ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

</aside>

ì ‘ê·¼ ê¶Œí•œì´ ê¸°ì—¬ì(`Contributor`)ì¸ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ì„ ìˆ˜í–‰í•œ í›„ Event Tickets ì„¤ì • ë©”ë‰´(`/wp-admin/admin.php?page=event-tickets-with-ticket-scanner`)ë¡œ ì´ë™í•˜ì—¬ í‹°ì¼“ í…œí”Œë¦¿ ì„¤ì • ì˜ì—­ìœ¼ë¡œ ì´ë™ í•©ë‹ˆë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-11-26 á„‹á…©á„’á…® 5.00.50.png](images/image-009.png)

í˜„ì¬ ìœ„ì™€ ê°™ì´ ì„¤ì •ëœ í…œí”Œë¦¿ ë‚´ìš©ì€ í‹°ì¼“ í˜ì´ì§€ë¥¼ ì•„ë˜ì™€ ê°™ì´ ì¶œë ¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2024-11-26 á„‹á…©á„’á…® 5.03.15.png](images/image-010.png)

ì´í›„ í…œí”Œë¦¿ ë‚´ìš©ì„ `cat /etc/passwd` ëª…ë ¹ì„ ìˆ˜í–‰í•˜ëŠ” ì•„ë˜ì˜ ì½”ë“œë¡œ ì‘ì„±í•©ë‹ˆë‹¤.

```
{{['cat /etc/passwd'] | filter('system')}}
```

![image.png](images/image-011.png)

ê·¸ ë‹¤ìŒ í‹°ì¼“ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì…ë ¥ëœ ëª…ë ¹ì–´ `cat /etc/passwd` ì˜ ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![image.png](images/image-012.png)

## ğŸ“ŒÂ íŒ¨ì¹˜í™•ì¸
> âš ï¸ ë³¸ ë‚´ìš©ì€ CVE-2024-52427 ì œë³´ìì˜ ì›ë³¸ PoC ì½”ë“œë¥¼ ì§ì ‘ í™•ì¸í•  ìˆ˜ ì—†ì–´, CVE ì œë³´ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì¬í˜„í•œ ê²°ê³¼ë¥¼ ì •ë¦¬í•œ ê²ƒì…ë‹ˆë‹¤.

[CVE-2024-52427](https://www.cve.org/CVERecord?id=CVE-2024-52427) ì •ë³´ì— ë”°ë¥´ë©´ í•´ë‹¹ ì·¨ì•½ì ì€ Event Tickets í”ŒëŸ¬ê·¸ì¸ `2.3.11` ì´í•˜ ë²„ì „ì—ì„œ ì˜í–¥ì„ ë°›ìœ¼ë©°, `2.3.12` ì´í›„ ë²„ì „ì—ì„œëŠ” ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ”ë‹¤ê³  ë‚˜ì™€ìˆìŠµë‹ˆë‹¤.

![image.png](images/image-013.png)

ê·¸ëŸ¬ë‚˜ í”ŒëŸ¬ê·¸ì¸ ê°œë°œ ê¸°ë¡ì„ í™•ì¸í•˜ê³  í•´ë‹¹ ì·¨ì•½ì ì— ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ” ë²„ì „ì˜ ìƒìœ„ ë²„ì „ì¸ `2.4.0` ì„ ëŒ€ìƒìœ¼ë¡œ PoCë¥¼ ìˆ˜í–‰í•œ ê²°ê³¼, íŒ¨ì¹˜ëŠ” `2.4.1` ë²„ì „ë¶€í„° ì´ë£¨ì–´ì§„ ê²ƒì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤.

> [https://plugins.trac.wordpress.org/changeset/3172740/event-tickets-with-ticket-scanner?old=3160714&old_path=%2Fevent-tickets-with-ticket-scanner#file1690](https://plugins.trac.wordpress.org/changeset/3172740/event-tickets-with-ticket-scanner?old=3160714&old_path=%2Fevent-tickets-with-ticket-scanner#file1690)
> 

![/wp-content/plugins/event-tickets-with-ticket-scanner/sasoEventtickets_Options.php](images/image-014.png)

/wp-content/plugins/event-tickets-with-ticket-scanner/sasoEventtickets_Options.php

ìœ„ ì½”ë“œ ë‚´ìš©ì€ Event Tickets í”ŒëŸ¬ê·¸ì¸ì˜ ì„¤ì • ë©”ë‰´ ì¤‘ ì•„ë˜ ì ‘ê·¼ê³¼ ê´€ë ¨ëœ ì„¤ì •ì…ë‹ˆë‹¤.

![image.png](images/image-015.png)

ì¦‰, Event Tickets í”ŒëŸ¬ê·¸ì¸ì˜ ì„¤ì • ë©”ë‰´ì˜ ì ‘ê·¼ ê¶Œí•œì„ ê´€ë¦¬ì(`Administrator`) ë˜ëŠ” ì ‘ê·¼ ì„¤ì •ì— ì„ íƒëœ ì—­í• ì—ë§Œ í• ë‹¹í•˜ëŠ” ê²ƒì„ ê¸°ë³¸ ê°’(Default)ìœ¼ë¡œ ì„¤ì •í•˜ê³  ìˆìŠµë‹ˆë‹¤. 

ë”°ë¼ì„œ, í•´ë‹¹ ì·¨ì•½ì ì€ Event Tickets í”ŒëŸ¬ê·¸ì¸ ì„¤ì • ë©”ë‰´ì˜ ê¸°ë³¸ ì ‘ê·¼ ê¶Œí•œì˜ ë³€ê²½ì„ í†µí•´ íŒ¨ì¹˜ ë˜ì—ˆìŠµë‹ˆë‹¤.